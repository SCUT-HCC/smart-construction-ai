# CLAUDE.md - 南网施工方案智能辅助系统

> [!IMPORTANT]
> **研究性项目 (Research Project)**
> 1. 本项目为 MVP（最小可行性产品），严禁过度工程化
> 2. 所有思考过程和回复必须使用 **简体中文**
> 3. 承璋的编程偏好已记录，必须遵守

---

## 1. 项目概览

### 1.1 项目名称
基于生成式AI技术的施工方案全生命周期智能构建与动态调控技术的研究与示范应用

### 1.2 项目目标
为南方电网减轻施工报告/施工方案的人力投入，构建智能化辅助系统，实现两个核心功能：

| 功能 | 描述 | 输入 | 输出 |
|------|------|------|------|
| **施工方案检测** | 对已有方案进行智能审核 | Markdown/PDF 施工方案 | 检测报告（问题清单 + 优化建议） |
| **施工方案生成** | 基于工程信息自动生成方案 | 工程基本信息 | 完整施工方案（7 大章节） |

### 1.3 项目周期
- **启动**：2026-01
- **中期检查**：2026-06-30（软件报告 + 源代码 + 2 篇论文初稿 + 1 项发明专利）
- **结项**：2026-12

---

## 2. 核心功能设计

### 2.1 施工方案检测（审核系统）

**检测维度**：

1. **章节完整性检查**
   - 标准 7 大章节：编制依据、工程概况、施工安排、施工准备、施工方法及工艺要求、施工保证措施、应急预案
   - 允许标题灵活命名，但内容必须覆盖 7 大方面
   - 输出：缺失章节清单 + 完整性评分

2. **编制依据时效性检查**
   - 识别方案引用的规范标准（国标、行标、企标）
   - 对比最新版本，标记过时引用
   - 输出：过时依据清单 + 建议更新版本

3. **合规性检查**
   - 工艺流程是否符合规范
   - 设备配置是否满足要求
   - 人员配备是否达标
   - 输出：合规性问题清单 + 规范条款引用

**技术实现思路**：
- 使用 RAG 检索相关规范条款
- LLM 语义理解 + 规则校验结合
- 多 Agent 协作（章节分析 Agent、依据检查 Agent、合规分析 Agent）

### 2.2 施工方案生成

**生成流程**：
1. 输入工程基本信息（工程名称、地点、规模、施工类型等）
2. 检索相似历史方案（从 16 份优质样本中检索）
3. 基于模板 `templates/standard_50502.md` 生成 7 大章节
4. 调用知识库填充具体内容（编制依据、工艺要求、安全措施等）
5. 风险点识别与保障措施生成

**技术实现思路**：
- 模板填充 + 案例参考结合
- LightRAG 语义检索优质方案片段
- 多 Agent 协作（信息提取 Agent、内容生成 Agent、质量校验 Agent）

---

## 3. 技术架构

### 3.1 技术栈
- **语言**：Python 3.10
- **框架**：LangChain + LangGraph（多智能体编排）
- **向量数据库**：ChromaDB
- **语义检索**：LightRAG
- **LLM**：DeepSeek / Claude（通过承璋转发节点）

### 3.2 系统架构

```
┌─────────────────────────────────────────────────────────────┐
│                        输入层                                │
├─────────────────────────────────────────────────────────────┤
│  PDF 文件  ──→  OCR 清洗管道  ──→  Markdown                │
│  Markdown 文件  ──────────────→  直接处理                   │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                    处理层（多智能体系统）                     │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐    ┌─────────────────┐                │
│  │   检测 Agent    │    │   生成 Agent    │                │
│  ├─────────────────┤    ├─────────────────┤                │
│  │ • 章节完整性    │    │ • 信息提取      │                │
│  │ • 依据时效性    │    │ • 内容生成      │                │
│  │ • 合规性检查    │    │ • 质量校验      │                │
│  └─────────────────┘    └─────────────────┘                │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                        知识层                                │
├─────────────────────────────────────────────────────────────┤
│  ChromaDB          │  LightRAG          │  文件系统         │
│  • 编制依据        │  • 优质方案片段    │  • 标准模板       │
│  • 规范标准        │  • 语义检索        │  • 清洗后数据     │
│  • 审核要点        │                    │                   │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                        输出层                                │
├─────────────────────────────────────────────────────────────┤
│  检测报告          │  施工方案          │  优化建议         │
│  • 问题清单        │  • 7 大章节        │  • 修订建议       │
│  • 合规评分        │  • Markdown 格式   │  • 风险提示       │
└─────────────────────────────────────────────────────────────┘
```

### 3.3 数据流

```
施工方案检测流程：
  输入(PDF/MD) → [OCR清洗] → 章节分割 → 知识库检索 → LLM分析 → 检测报告

施工方案生成流程：
  工程信息 → 模板加载 → 案例检索 → LLM生成 → 质量校验 → 输出方案
```

---

## 4. 数据资源

### 4.1 原始数据
- **位置**：`data/` 目录
- **内容**：16 份南方电网施工方案 PDF（178MB）
- **格式**：原始扫描件 / 电子文档

### 4.2 清洗后数据
- **位置**：`output/1-16/final.md`
- **处理流程**：
  1. OCR 识别（MonkeyOCR API）
  2. 正则清洗（去除水印、页码、LaTex 装饰符等）
  3. LLM 语义清洗（标题合并、段落流优化、结构规范化）

### 4.3 数据用途
| 用途 | 说明 |
|------|------|
| **优质方案样本** | 作为施工方案生成的案例/参考，学习表达风格和逻辑结构 |
| **检测性能测试** | 作为金标准测试集，验证检测系统的准确性 |
| **OCR 清洗管道** | 已验证的 PDF 处理流程，未来系统可直接复用 |

### 4.4 标准模板
- **位置**：`templates/standard_50502.md`
- **标准**：GB/T 50502-2009《建筑施工组织设计规范》
- **结构**：7 大章节，二级标题细分

---

## 5. 开发规范

> [!WARNING]
> **严格遵守 AGENTS.md 中的工程规则**

### 5.1 MVP 原则
- ❌ 严禁过度工程化
- ❌ 严禁随意添加测试代码
- ❌ 严禁用默认参数掩盖逻辑
- ✅ 先跑通再迭代

### 5.2 代码规范
- **类型注解**：强制完整类型注解（Union, Dict, Optional 等）
- **文档**：所有模块、类、方法必须包含 **中文 Docstring**
- **日志**：必须使用 `utils/logger_system.py` 的 `log_msg()` 和 `log_json()`
- **命名**：类名 PascalCase，变量描述性命名

### 5.3 Git 工作流
- **提交格式**：Conventional Commits（feat:, fix:, docs:, refactor:）
- **禁止**：commit message 中添加任何 AI 标识
- **策略**：不考虑向后兼容，直接修改原文件

### 5.4 conda 环境
- **环境名**：`sca` (Python 3.10)
- **激活**：`conda activate sca`
- **注意**：所有 Python 代码必须在此环境下运行

---

## 6. 开发路线图

### Phase 1: 施工报告拆解（已完成 ✅）
- [x] OCR 转换 16 份 PDF
- [x] 正则清洗 + LLM 语义清洗
- [ ] 施工方案模板构建（细化到二级标题 + 大纲）
- [ ] 16 篇方案拆解为标准化模块

### Phase 2: 施工知识库构建（2026-03）
- [ ] 部署 ChromaDB
- [ ] 部署 LightRAG
- [ ] 构建编制依据列表并存入 ChromaDB
- [ ] 获取专家审核要点（对接李文霸）
- [ ] 爬取标准库数据（OCR + 清洗 + 入库）

### Phase 3: 施工方案生成（2026-04）
- [ ] 施工方案 demo 生成
- [ ] 施工方案风险点生成
- [ ] 施工方案合规分析
- [ ] 施工方案工序冲突分析

### Phase 4: 施工方案审核（2026-05~06）
- [ ] 自动化审核报告生成
- [ ] 优化建议生成

### Phase 5: 中期检查准备（2026-06-30）
- [ ] 施工方案全过程管理软件应用报告（中期版）
- [ ] 施工方案全过程管理软件源代码（阶段性版本）
- [ ] 论文初稿 2 篇
- [ ] 受理发明专利 1 项

---

## 7. 待确认问题

1. 现场勘查报告和地质勘查报告怎么做？
2. 人员配置识别的具体要求？
3. 无法分析现场实际人员和设备（只能分析方案中的人员设备配置）
4. 5.3/5.4 是否属于系统功能（施工方案过程管理软件）？
5. 李文霸、朱晨旭对接"施工方案过程管理软件"

---

## 8. 关键联系人

- **承璋**：项目负责人，博士研究生
- **李文霸**：专家审核要点对接
- **朱晨旭**：施工方案过程管理软件对接

---

## 9. 参考资源

- **Obsidian 项目文件**：`/Users/openclaw/ObsidianVault/Projects/基于生成式AI技术的施工方案全生命周期智能构建与动态调控技术的研究与示范应用.md`
- **MEMORY.md**：睿睿的长期记忆，包含项目关键信息
- **AGENTS.md**：本项目的工程规范（已存在）
- **README.md**：OCR 清洗工具说明（已存在）

---

*此文件由睿睿创建，用于为 coding agent 提供完整的项目上下文。*
